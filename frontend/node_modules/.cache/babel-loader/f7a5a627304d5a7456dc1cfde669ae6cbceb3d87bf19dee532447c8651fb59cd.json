{"ast":null,"code":"// frontend/src/services/api.js\n\nconst API = process.env.REACT_APP_API || 'http://localhost:4000/api';\nexport async function request(path, options = {}) {\n  const token = localStorage.getItem('token');\n  const isFormData = options.body instanceof FormData;\n  const headers = {\n    ...(options.headers || {})\n  };\n  if (!isFormData) {\n    headers['Content-Type'] = 'application/json';\n  }\n  if (token) {\n    headers['Authorization'] = `Bearer ${token}`;\n  }\n  const res = await fetch(`${API}${path}`, {\n    ...options,\n    headers\n  });\n  const text = await res.text();\n  let data;\n  try {\n    data = text ? JSON.parse(text) : null;\n  } catch {\n    data = text;\n  }\n  if (!res.ok) {\n    const errorBody = data || text;\n    const err = new Error((errorBody === null || errorBody === void 0 ? void 0 : errorBody.message) || (errorBody === null || errorBody === void 0 ? void 0 : errorBody.error) || res.statusText || 'Erro na requisição');\n    err.status = res.status;\n    err.body = errorBody;\n    throw err;\n  }\n  return data;\n}\nexport async function login(email, password) {\n  const res = await request('/login', {\n    method: 'POST',\n    body: JSON.stringify({\n      email,\n      password\n    })\n  });\n\n  // O backend deve retornar um JSON com `token` e `user`\n  return {\n    token: res.token,\n    user: res.user\n  };\n}\nexport async function register(name, email, password, role) {\n  return request('/register', {\n    method: 'POST',\n    body: JSON.stringify({\n      name,\n      email,\n      password,\n      role\n    })\n  });\n}\nexport async function registerProduct(productData) {\n  // O backend precisa retornar o objeto completo do produto com o ID\n  return request('/products', {\n    method: 'POST',\n    body: JSON.stringify(productData)\n  });\n}\nexport async function uploadImages(files, productId) {\n  if (!localStorage.getItem('token')) {\n    throw new Error('Token não fornecido.');\n  }\n  const formData = new FormData();\n  files.forEach(file => {\n    formData.append('images', file);\n  });\n  return request(`/products/${productId}/images`, {\n    // Novo endpoint com o ID\n    method: 'POST',\n    body: formData\n  });\n}\nexport async function editProduct(id, productData) {\n  return request(`/products/${id}`, {\n    method: 'PUT',\n    body: JSON.stringify(productData)\n  });\n}\nexport async function deleteProduct(id) {\n  return request(`/products/${id}`, {\n    method: 'DELETE'\n  });\n}\nexport async function getSellerProducts() {\n  return request('/my-products', {\n    method: 'GET'\n  });\n}\nexport async function getSellerSales() {\n  return request('/sales', {\n    method: 'GET'\n  });\n}\nexport async function getProducts() {\n  return request('/products');\n}\nexport async function getProductById(id) {\n  return request(`/products/${id}`);\n}\nexport async function finalizarCompra(orderData) {\n  return request('/checkout', {\n    method: 'POST',\n    body: JSON.stringify(orderData)\n  });\n}","map":{"version":3,"names":["API","process","env","REACT_APP_API","request","path","options","token","localStorage","getItem","isFormData","body","FormData","headers","res","fetch","text","data","JSON","parse","ok","errorBody","err","Error","message","error","statusText","status","login","email","password","method","stringify","user","register","name","role","registerProduct","productData","uploadImages","files","productId","formData","forEach","file","append","editProduct","id","deleteProduct","getSellerProducts","getSellerSales","getProducts","getProductById","finalizarCompra","orderData"],"sources":["C:/Users/Samuel Alves/Desktop/Integrador/frontend/src/services/api.js"],"sourcesContent":["// frontend/src/services/api.js\n\nconst API = process.env.REACT_APP_API || 'http://localhost:4000/api';\n\nexport async function request(path, options = {}) {\n  const token = localStorage.getItem('token');\n  \n  const isFormData = options.body instanceof FormData;\n  \n  const headers = { \n    ...(options.headers || {}) \n  };\n\n  if (!isFormData) {\n    headers['Content-Type'] = 'application/json';\n  }\n\n  if (token) {\n    headers['Authorization'] = `Bearer ${token}`;\n  }\n\n  const res = await fetch(`${API}${path}`, { ...options, headers });\n  \n  const text = await res.text();\n  let data;\n  try { \n    data = text ? JSON.parse(text) : null; \n  } catch { \n    data = text; \n  }\n\n  if (!res.ok) {\n    const errorBody = data || text;\n    const err = new Error(errorBody?.message || errorBody?.error || res.statusText || 'Erro na requisição');\n    err.status = res.status;\n    err.body = errorBody;\n    throw err;\n  }\n  return data;\n}\n\nexport async function login(email, password) {\n  const res = await request('/login', {\n    method: 'POST',\n    body: JSON.stringify({ email, password }),\n  });\n  \n  // O backend deve retornar um JSON com `token` e `user`\n  return {\n    token: res.token,\n    user: res.user,\n  };\n}\n\nexport async function register(name, email, password, role) {\n  return request('/register', {\n    method: 'POST',\n    body: JSON.stringify({ name, email, password, role }),\n  });\n}\n\nexport async function registerProduct(productData) {\n    // O backend precisa retornar o objeto completo do produto com o ID\n    return request('/products', {\n        method: 'POST',\n        body: JSON.stringify(productData),\n    });\n}\n\nexport async function uploadImages(files, productId) {\n    if (!localStorage.getItem('token')) {\n        throw new Error('Token não fornecido.');\n    }\n\n    const formData = new FormData();\n    files.forEach(file => {\n        formData.append('images', file);\n    });\n\n    return request(`/products/${productId}/images`, { // Novo endpoint com o ID\n        method: 'POST',\n        body: formData,\n    });\n}\n\nexport async function editProduct(id, productData) {\n    return request(`/products/${id}`, {\n      method: 'PUT',\n      body: JSON.stringify(productData),\n    });\n  }\n  \nexport async function deleteProduct(id) {\n    return request(`/products/${id}`, {\n      method: 'DELETE',\n      });\n  }\n\nexport async function getSellerProducts() {\n  return request('/my-products', {\n    method: 'GET',\n  });\n}\n\nexport async function getSellerSales() {\n  return request('/sales', {\n    method: 'GET',\n  });\n}\n\nexport async function getProducts() {\n  return request('/products');\n}\n\nexport async function getProductById(id) {\n  return request(`/products/${id}`);\n}\n\nexport async function finalizarCompra(orderData) {\n  return request('/checkout', {\n    method: 'POST',\n    body: JSON.stringify(orderData),\n  });\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}