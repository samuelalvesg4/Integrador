{"ast":null,"code":"var _jsxFileName = \"D:\\\\Users\\\\sasuk\\\\OneDrive\\\\Documentos\\\\estudo\\\\Integrador\\\\frontend\\\\src\\\\context\\\\CartContext.jsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useState, useContext, useEffect } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst CartContext = /*#__PURE__*/createContext();\nexport const useCart = () => {\n  _s();\n  return useContext(CartContext);\n};\n_s(useCart, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\nexport const CartProvider = ({\n  children\n}) => {\n  _s2();\n  const [cartItems, setCartItems] = useState(() => {\n    try {\n      const localData = localStorage.getItem('cartItems');\n      return localData ? JSON.parse(localData) : [];\n    } catch (error) {\n      return [];\n    }\n  });\n  const [selectedItems, setSelectedItems] = useState(() => {\n    const localData = localStorage.getItem('cartItems');\n    const items = localData ? JSON.parse(localData) : [];\n    return items.map(item => item.id);\n  });\n\n  // --- NOVO ESTADO APENAS PARA O CHECKOUT ---\n  const [checkoutItems, setCheckoutItems] = useState([]);\n  useEffect(() => {\n    localStorage.setItem('cartItems', JSON.stringify(cartItems));\n  }, [cartItems]);\n  const addToCart = (product, quantity = 1) => {\n    const itemInCart = cartItems.find(item => item.id === product.id);\n    const currentQuantityInCart = itemInCart ? itemInCart.quantity : 0;\n    if (currentQuantityInCart + quantity > product.stock) {\n      alert(\"A quantidade solicitada excede o estoque disponível.\");\n      return false; // Retorna false se não foi possível adicionar\n    }\n    setCartItems(prevItems => {\n      const existingItem = prevItems.find(item => item.id === product.id);\n      if (existingItem) {\n        return prevItems.map(item => item.id === product.id ? {\n          ...item,\n          quantity: item.quantity + quantity\n        } : item);\n      } else {\n        setSelectedItems(prevSelected => [...prevSelected, product.id]);\n        return [...prevItems, {\n          ...product,\n          quantity\n        }];\n      }\n    });\n    return true; // Retorna true se adicionou com sucesso\n  };\n  const removeItemFromCart = id => {\n    setCartItems(prevItems => prevItems.filter(item => item.id !== id));\n    setSelectedItems(prevSelected => prevSelected.filter(itemId => itemId !== id));\n  };\n  const clearCart = () => {\n    // Agora, clearCart limpa o carrinho principal, não os itens do checkout.\n    // const itemsToRemove = cartItems.filter(item => selectedItems.includes(item.id));\n    const newCartItems = cartItems.filter(item => !selectedItems.includes(item.id));\n    setCartItems(newCartItems);\n    setSelectedItems([]);\n    setCheckoutItems([]);\n  };\n  const toggleItemSelection = productId => {\n    setSelectedItems(prevSelected => prevSelected.includes(productId) ? prevSelected.filter(id => id !== productId) : [...prevSelected, productId]);\n  };\n  const toggleSelectAll = () => {\n    if (selectedItems.length === cartItems.length) {\n      setSelectedItems([]);\n    } else {\n      setSelectedItems(cartItems.map(item => item.id));\n    }\n  };\n\n  // --- NOVA FUNÇÃO PARA INICIAR O CHECKOUT DE FORMA SEGURA ---\n  const startCheckout = itemsToCheckout => {\n    setCheckoutItems(itemsToCheckout);\n  };\n\n  // ... (função updateItemQuantity sem alteração)\n  const updateItemQuantity = (id, delta) => {\n    setCartItems(prevItems => {\n      return prevItems.map(item => item.id === id ? {\n        ...item,\n        quantity: Math.max(1, item.quantity + delta)\n      } : item);\n    });\n  };\n  const value = {\n    cartItems,\n    addToCart,\n    updateItemQuantity,\n    removeItemFromCart,\n    clearCart,\n    selectedItems,\n    toggleItemSelection,\n    toggleSelectAll,\n    // --- EXPOR NOVOS VALORES ---\n    checkoutItems,\n    startCheckout\n  };\n  return /*#__PURE__*/_jsxDEV(CartContext.Provider, {\n    value: value,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 111,\n    columnNumber: 12\n  }, this);\n};\n_s2(CartProvider, \"OfwLzFHP9+KAHHGyVDoYPUrI6Qs=\");\n_c = CartProvider;\nvar _c;\n$RefreshReg$(_c, \"CartProvider\");","map":{"version":3,"names":["React","createContext","useState","useContext","useEffect","jsxDEV","_jsxDEV","CartContext","useCart","_s","CartProvider","children","_s2","cartItems","setCartItems","localData","localStorage","getItem","JSON","parse","error","selectedItems","setSelectedItems","items","map","item","id","checkoutItems","setCheckoutItems","setItem","stringify","addToCart","product","quantity","itemInCart","find","currentQuantityInCart","stock","alert","prevItems","existingItem","prevSelected","removeItemFromCart","filter","itemId","clearCart","newCartItems","includes","toggleItemSelection","productId","toggleSelectAll","length","startCheckout","itemsToCheckout","updateItemQuantity","delta","Math","max","value","Provider","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["D:/Users/sasuk/OneDrive/Documentos/estudo/Integrador/frontend/src/context/CartContext.jsx"],"sourcesContent":["import React, { createContext, useState, useContext, useEffect } from 'react';\r\n\r\nconst CartContext = createContext();\r\n\r\nexport const useCart = () => useContext(CartContext);\r\n\r\nexport const CartProvider = ({ children }) => {\r\n    const [cartItems, setCartItems] = useState(() => {\r\n        try {\r\n            const localData = localStorage.getItem('cartItems');\r\n            return localData ? JSON.parse(localData) : [];\r\n        } catch (error) { return []; }\r\n    });\r\n\r\n    const [selectedItems, setSelectedItems] = useState(() => {\r\n        const localData = localStorage.getItem('cartItems');\r\n        const items = localData ? JSON.parse(localData) : [];\r\n        return items.map(item => item.id);\r\n    });\r\n\r\n    // --- NOVO ESTADO APENAS PARA O CHECKOUT ---\r\n    const [checkoutItems, setCheckoutItems] = useState([]);\r\n\r\n    useEffect(() => {\r\n        localStorage.setItem('cartItems', JSON.stringify(cartItems));\r\n    }, [cartItems]);\r\n\r\n    const addToCart = (product, quantity = 1) => { \r\n    const itemInCart = cartItems.find((item) => item.id === product.id);\r\n    const currentQuantityInCart = itemInCart ? itemInCart.quantity : 0;\r\n\r\n    if (currentQuantityInCart + quantity > product.stock) {\r\n        alert(\"A quantidade solicitada excede o estoque disponível.\");\r\n        return false; // Retorna false se não foi possível adicionar\r\n    }\r\n\r\n    setCartItems((prevItems) => {\r\n        const existingItem = prevItems.find((item) => item.id === product.id);\r\n        if (existingItem) {\r\n            return prevItems.map((item) =>\r\n                item.id === product.id ? { ...item, quantity: item.quantity + quantity } : item\r\n            );\r\n        } else {\r\n            setSelectedItems(prevSelected => [...prevSelected, product.id]);\r\n            return [...prevItems, { ...product, quantity }];\r\n        }\r\n    });\r\n\r\n    return true; // Retorna true se adicionou com sucesso\r\n};\r\n    \r\n    const removeItemFromCart = (id) => {\r\n        setCartItems((prevItems) => prevItems.filter((item) => item.id !== id));\r\n        setSelectedItems(prevSelected => prevSelected.filter(itemId => itemId !== id));\r\n    };\r\n\r\n    const clearCart = () => {\r\n        // Agora, clearCart limpa o carrinho principal, não os itens do checkout.\r\n        // const itemsToRemove = cartItems.filter(item => selectedItems.includes(item.id));\r\n        const newCartItems = cartItems.filter(item => !selectedItems.includes(item.id));\r\n        setCartItems(newCartItems);\r\n        setSelectedItems([]);\r\n        setCheckoutItems([]);\r\n    };\r\n\r\n    const toggleItemSelection = (productId) => {\r\n        setSelectedItems(prevSelected =>\r\n            prevSelected.includes(productId)\r\n                ? prevSelected.filter(id => id !== productId)\r\n                : [...prevSelected, productId]\r\n        );\r\n    };\r\n\r\n    const toggleSelectAll = () => {\r\n        if (selectedItems.length === cartItems.length) {\r\n            setSelectedItems([]);\r\n        } else {\r\n            setSelectedItems(cartItems.map(item => item.id));\r\n        }\r\n    };\r\n    \r\n    // --- NOVA FUNÇÃO PARA INICIAR O CHECKOUT DE FORMA SEGURA ---\r\n    const startCheckout = (itemsToCheckout) => {\r\n        setCheckoutItems(itemsToCheckout);\r\n    };\r\n\r\n    // ... (função updateItemQuantity sem alteração)\r\n    const updateItemQuantity = (id, delta) => {\r\n        setCartItems((prevItems) => {\r\n            return prevItems.map((item) =>\r\n                item.id === id ? { ...item, quantity: Math.max(1, item.quantity + delta) } : item\r\n            );\r\n        });\r\n    };\r\n\r\n\r\n    const value = {\r\n        cartItems,\r\n        addToCart,\r\n        updateItemQuantity,\r\n        removeItemFromCart,\r\n        clearCart,\r\n        selectedItems,\r\n        toggleItemSelection,\r\n        toggleSelectAll,\r\n        // --- EXPOR NOVOS VALORES ---\r\n        checkoutItems,\r\n        startCheckout,\r\n    };\r\n\r\n    return <CartContext.Provider value={value}>{children}</CartContext.Provider>;\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}